<!-- templates/admin/products/report.html -->
<div th:fragment="content" class="container mt-4">

  <!-- 🌟 PHẦN 1️⃣: Quản lý Báo cáo -->
  <div class="card shadow-lg border-0 rounded-4 mb-5">
    <div class="card-header bg-gradient bg-primary text-white text-center fs-4 fw-bold">
      🧾 Quản lý Báo cáo
    </div>

    <div class="card-body">
      <input type="hidden" id="reportId">

      <!-- Dòng chọn loại, người lập, ghi chú -->
      <div class="row g-2 align-items-center mb-3">
        <div class="col-md-3">
          <select id="reportType" class="form-select">
            <option value="Doanh thu tháng">Doanh thu tháng</option>
            <option value="Tồn kho">Tồn kho</option>
            <option value="Sản phẩm bán chạy">Sản phẩm bán chạy</option>
          </select>
        </div>
        <div class="col-md-3">
          <input type="text" id="reportCreator" class="form-control" placeholder="Người lập báo cáo">
        </div>
        <div class="col-md-4">
          <input type="text" id="reportNote" class="form-control" placeholder="Ghi chú (nếu có)">
        </div>
        <div class="col-md-2 d-flex gap-2">
          <button id="createBtn" class="btn btn-primary flex-fill" onclick="createReport()">➕ Tạo</button>
          <button id="updateBtn" class="btn btn-success flex-fill d-none" onclick="updateReport()">💾 Lưu</button>
          <button id="cancelBtn" class="btn btn-secondary flex-fill d-none" onclick="cancelEdit()">❌ Huỷ</button>
        </div>
      </div>

      <!-- Dòng nhập doanh thu / đơn hàng / tồn kho -->
      <div class="row g-3 mb-4">
        <div class="col-md-4">
          <label class="form-label fw-semibold">💰 Doanh thu</label>
          <input type="number" id="reportRevenue" class="form-control" placeholder="Nhập tổng doanh thu (VNĐ)">
        </div>
        <div class="col-md-4">
          <label class="form-label fw-semibold">📦 Tổng đơn hàng</label>
          <input type="number" id="reportOrders" class="form-control" placeholder="Nhập số lượng đơn hàng">
        </div>
        <div class="col-md-4">
          <label class="form-label fw-semibold">🛒 Sản phẩm tồn kho</label>
          <input type="number" id="reportStock" class="form-control" placeholder="Nhập số sản phẩm tồn">
        </div>
      </div>

      <!-- Nút thao tác -->
      <div class="mb-3 text-end">
        <button class="btn btn-outline-secondary me-2" onclick="loadReports()">📄 Xem báo cáo</button>
        <button class="btn btn-outline-success" onclick="exportReportWord()">⬇️ Xuất Word</button>
      </div>

      <!-- Bảng kết quả -->
      <div id="reportTable" class="mt-3">
        <div class="alert alert-info text-center">Chưa có báo cáo nào được tạo</div>
      </div>
    </div>
  </div>

  <!-- 📊 PHẦN 2️⃣: Thống kê -->
  <div class="card shadow-lg border-0 rounded-4">
    <div class="card-header bg-gradient bg-success text-white text-center fs-4 fw-bold">
      📊 Thống kê doanh thu & sản phẩm
    </div>

    <div class="card-body">

      <div class="mb-4">
        <label class="fw-semibold me-2"><i class="bi bi-funnel"></i> Chọn chế độ:</label>
        <select id="modeSelect" class="form-select d-inline-block w-auto" onchange="toggleInputs()">
          <option value="day">Theo ngày</option>
          <option value="month">Theo tháng</option>
          <option value="year">Theo năm</option>
        </select>
      </div>

      <div id="inputDay" class="mb-3">
        <label class="fw-semibold">
          <i class="bi bi-calendar3"></i> Ngày:
          <input type="date" id="reportDate" class="form-control d-inline-block w-auto ms-2">
        </label>
      </div>

      <div id="inputMonthYear" class="mb-3 d-none">
        <label class="fw-semibold me-2">Tháng:</label>
        <input type="number" id="reportMonth" class="form-control d-inline-block w-auto" min="1" max="12" value="1">
        <label class="fw-semibold ms-3 me-2">Năm:</label>
        <input type="number" id="reportYear" class="form-control d-inline-block w-auto" min="2000" value="2025">
      </div>

      <div id="inputYear" class="mb-3 d-none">
        <label class="fw-semibold">
          <i class="bi bi-calendar"></i> Năm:
          <input type="number" id="onlyYear" class="form-control d-inline-block w-auto ms-2" min="2000" value="2025">
        </label>
      </div>

      <div class="mb-4 btn-group flex-wrap" role="group">
        <button class="btn btn-success" onclick="getRevenue()">💰 Doanh thu</button>
        <button class="btn btn-info text-white" onclick="getOrderCount()">📦 Đơn hàng</button>
      </div>

      <div id="reportResult" class="mt-4">
        <div class="alert alert-secondary text-center" role="alert">
          Chưa có dữ liệu, vui lòng chọn thao tác phía trên 👆
        </div>
      </div>
    </div>
  </div>

  <script src="/js/admin/report.js"></script>
</div>
